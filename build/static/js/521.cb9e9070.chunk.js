"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[521],{8521:function(e,n,t){t.r(n),t.d(n,{default:function(){return x}});var s=t(2791),r=t(4165),a=t(5861),c=t(3433),o=t(9439),l=(0,t(1006).io)("https://mental-health-backend-26w3.onrender.com"),u=t(4971),i=t(456),d=t(184),f=function(e){var n=e.chatId,t=(0,s.useState)([]),f=(0,o.Z)(t,2),h=f[0],x=f[1],m=(0,s.useState)(""),g=(0,o.Z)(m,2),p=g[0],v=g[1],b=(0,s.useState)(localStorage.getItem("token")?(0,i.Z)(localStorage.getItem("token")):""),j=(0,o.Z)(b,1)[0];(0,s.useEffect)((function(){function e(){console.log("Connected")}function t(){console.log("Disconnected")}return(0,u.ZP)("/messages/".concat(n)).then((function(e){console.log(e),x(e.messages)})).catch((function(e){console.error(e)})),l.on("connect",e),l.on("disconnect",t),l.emit("joinChat",n),l.on("message",(function(e){x((function(n){return[].concat((0,c.Z)(n),[e])}))})),function(){l.off("connect",e),l.off("disconnect",t),l.off("message")}}),[]);var y=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.preventDefault(),p){e.next=4;break}return e.abrupt("return");case 4:return s={message:p,sender_id:j.userId,chat_id:n},e.next=7,(0,u.qC)("/messages",s);case 7:l.emit("sendMessage",s),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0);case 13:v("");case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(n){return e.apply(this,arguments)}}(),w=function(e){var n=new Date(e);return"".concat(n.toLocaleTimeString())};return(0,d.jsx)("div",{className:"h-fill bg-gray-100",children:(0,d.jsxs)("div",{className:"p-6",children:[(0,d.jsx)("div",{className:"overflow-y-auto h-[75vh] mb-6 space-y-4",children:null===h||void 0===h?void 0:h.map((function(e,n){return(0,d.jsx)("div",{className:"flex flex-col my-2",children:(0,d.jsxs)("div",{className:"flex flex-col justify-between rounded-xl px-4 py-2 mb-1 ".concat(e.sender_id===j.userId?"bg-blue-500 text-white self-end":"bg-gray-300 self-start"),children:[(0,d.jsx)("span",{children:e.message}),(0,d.jsx)("span",{className:"text-xs text-gray-500 self-start",children:w(e.createdAt)})]})},n)}))}),(0,d.jsxs)("form",{onSubmit:y,className:"flex",children:[(0,d.jsx)("input",{value:p,onChange:function(e){return v(e.target.value)},placeholder:"Type a message...",type:"text",className:"flex-grow rounded-l-xl p-2 border border-gray-300"}),(0,d.jsx)("button",{className:"bg-green-500 text-white rounded-r-xl px-4 py-2",children:"Send"})]})]})})},h=t(7689);var x=function(){var e=(0,h.UO)();return(0,d.jsx)(f,{chatId:e.chatId})}}}]);
//# sourceMappingURL=521.cb9e9070.chunk.js.map